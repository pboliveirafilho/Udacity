EDA - White Wine (PEDRO BARBOSA DE OLIVEIRA FILHO)
========================================================

```{r echo=FALSE, message=FALSE, warning=FALSE, packages}
# Carregue aqui todos os pacotes utilizados 
# na sua análise realizada neste arquivo fonte.

# Note que o parâmetro "echo" foi definido como FALSE neste código.
# Isso previne que o código apresente resultados formatados em HTML.
# Você deve definir  para todos os blocos de código no seu arquivo.

library(dplyr)
library(ggplot2)
library(knitr)
library(lubridate)
library(psych)
library(GGally)
library(scales)
library(ggthemes)
library(gridExtra)
library(corrplot)
```

# Visão Geral

O conjunto de dados em estudo contém 4.898 vinhos brancos com 11 variáveis de propriedades químicas do vinho. Ao menos 3 especialistas em vinhos avaliaram cada vinho, fornecendo uma nota entre 0 (muito ruim) e 10 (muito excelente). Este [arquivo texto](https://s3.amazonaws.com/udacity-hosted-downloads/ud651/wineQualityInfo.txt) descreve as variáveis e como os dados foram coletados.

# Questão Guia

Quais propriedades químicas influenciam a qualidade dos vinhos brancos?

```{r echo=FALSE, warning=FALSE, Load_the_Data}
# Carregamento dos dados
white_wine <- read.csv(file = "wineQualityWhites.csv")
```

# Seção de Gráficos Univariados

Um resumo das 12 variáveis presentes no conjunto de dados é apresentado abaixo. Cada uma das variáveis será explorada separademente nesta seção.

```{r, echo=FALSE, warning=FALSE}
# EStrutura dos dados
str(white_wine)

# Resumos das estatísticas básicas
summary(white_wine)
```

Nota-se que nenhuma das variáveis apresenta NA's.

```{r, warning=FALSE}
colSums(is.na(white_wine))
```

### Acidez Fixa - fixed acidity (tartaric acid - g / dm^3)

Trata-se da maioria dos ácidos envolvidos com o vinho ou fixos ou não voláteis (não se evaporam prontamente).

```{r, echo=FALSE, warning=FALSE}
# Histrograma
fa1 <- ggplot(aes(x = fixed.acidity), data = white_wine) +
  geom_histogram(binwidth = 0.1)

# Box plot
fa2 <- ggplot(aes(x = "X", y = fixed.acidity), data = white_wine) +
  geom_boxplot() +
  coord_flip() 

# Organizando exibição dos gráficos
grid.arrange(fa1, fa2, ncol = 1)
```

```{r, echo=FALSE, warning=FALSE}
# Estatísticas básicas
summary(white_wine$fixed.acidity)
```

Nota-se que a maioria dos vinhos apresnetam uma acidez fixa entre 6.3 e 7.3 g/dm^3. Também é possível perceber a presença de outliers.

### Acidez Volátil - volatile acidity (acetic acid - g / dm^3)

Trata-se da quantidade de ácido acético no vinho, que em altíssimos níveis pode levar a um gosto desagradável de vinagre.

```{r, echo=FALSE, warning=FALSE}
# Histograma
va1 <- ggplot(aes(x = volatile.acidity), data = white_wine) +
  geom_histogram(binwidth = 0.01)

# Box plot
va2 <- ggplot(aes(x = "X", y = volatile.acidity), data = white_wine) +
  geom_boxplot() +
  coord_flip()

# Organizando exibição dos gráficos
grid.arrange(va1, va2, ncol = 1)
```

```{r, echo=FALSE, warning=FALSE}
# Estatísticas básicas
summary(white_wine$volatile.acidity)
```

Nota-se que a maioria dos vinhos apresnetam uma acidez volátil entre 0.21 e 0.32 g/dm^3. Também é possível perceber um crescimento à direita da cauda da distribuição. O código abaixo mostra a existência de 186 outliers à direita da distribuição.

```{r, warning=FALSE}
# Valor limite do bigode superior do box plot
va_upper_wisker <- quantile(white_wine$volatile.acidity, 0.75) + 1.5 * IQR(white_wine$volatile.acidity)

# Número de outliers à direita da distribuição
table(white_wine$volatile.acidity > va_upper_wisker)
```

Pode-se utilizar a escala logarítmica de base 10 para aproximar a distribuição dos dados de acidez volátil de um formato normal.

```{r, echo=FALSE, warning=FALSE}
# Histograma com escala logarítmica 
ggplot(aes(x = volatile.acidity), data = white_wine) +
  geom_histogram(binwidth = 0.025) +
  scale_x_log10()
```

Nota-se que utilização da escala logarítmica reduz o tamanho da cauda à direita.

### Ácido Cítrico - citric acid (g / dm^3)

Encontrado em pequenas quantidades, o ácido cítrico pode adicionar frescor e sabor aos vinhos.

```{r, echo=FALSE, warning=FALSE}
# Histograma
ca1 <- ggplot(aes(x = citric.acid), data = white_wine) +
  geom_histogram(binwidth = 0.01)

# Box plot
ca2 <- ggplot(aes(x = "X", y = citric.acid), data = white_wine) +
  geom_boxplot() +
  coord_flip()

# Organizando exibição dos gráficos
grid.arrange(ca1, ca2, ncol = 1)
```

```{r, echo=FALSE, warning=FALSE}
# Estatísticas básicas
summary(white_wine$citric.acid)
```

Nota-se que a maioria dos vinhos apresentam uma concentração de ácido cítrico entre 0.27 e 0.39 g/dm^3. Também é possível perceber mais de 200 vinhos apresentando uma concentração de ácido cítrico póxima a 0.50 g/dm^3.

O código abaixo mostra que 185 vinhos brancos apresentaram elevada concentração de ácido cítrico e foram considerados outliers. Também há indicação de 85 vinhos com baixas concentrações de ácido cítrico.

```{r, warning=FALSE}
# Valor limite do bigode superior do box plot
ca_upper_wisker <- quantile(white_wine$citric.acid, 0.75) + 1.5 * IQR(white_wine$citric.acid)

# # Valor limite do bigode inferior do box plot
ca_lower_wisker <- quantile(white_wine$citric.acid, 0.25) - 1.5 * IQR(white_wine$citric.acid)

# Número de outliers à direita da distribuição
table(white_wine$citric.acid > ca_upper_wisker)

# Número de outliers à esquerda da distribuição
table(white_wine$citric.acid < ca_lower_wisker)
```

### Açúcar Residual - residual sugar (g / dm^3)

Trata-se da quantidade de açúcar restante após a o fim da fermentação. É raro encontrar vinhos com menos de 1 g/L sendo os vinhos com mais de 45 g/L considerados doces.

```{r, echo=FALSE, warning=FALSE}
# Histograma
rs1 <- ggplot(aes(x = residual.sugar), data = white_wine) +
  geom_histogram(binwidth = 0.25)

# Box plot
rs2 <- ggplot(aes(x = "X", y = residual.sugar), data = white_wine) +
  geom_boxplot() +
  coord_flip()

# Organizando exibição dos gráficos
grid.arrange(rs1, rs2, ncol = 1)
```

```{r, echo=FALSE, warning=FALSE}
# Estatísticas básicas
summary(white_wine$residual.sugar)
```

Nota-se que a maioria dos vinhos apresentam concentração de acúcar residual entre 1.7 e 9.9 g/dm^3. O código abaixo mostra que apenas 77 vinhos brancos apresnetaram concentração de açúcar inferior a 1 g/L, enquanto apenas um vinho branco foi consederado doce (concentração maior que 45 g/L).

```{r, warning=FALSE}
# Vinhos com concentração de açúcar inferior a 1 g/L
table(white_wine$residual.sugar < 1)

# Vinhos com concentração de açúcar superior a 45 g/L
table(white_wine$residual.sugar > 45)
```

Também é possível perceber que a distribuição apresenta uma cauda longa para a direita. Assim, podemos aplicar a escala logarítmica de base 10 para aproxiamar à distribuição da normal.

```{r, echo=FALSE, warning=FALSE}
# Histograma com escala logarítmica
ggplot(aes(x = residual.sugar), data = white_wine) +
  geom_histogram(binwidth = 0.05) +
  scale_x_log10()
```

A escala logarítmica revelou uma característica bimodal da distribuição de concentração de açúcar residual. O código abaixo permite afirmar que existem 77 vinhos com concentração inferior a 1 g/dm^3 e apenas 1 vinho doce.

```{r, warning=FALSE}
# Vinhos com concentração de açúcar residual inferior a 1 g/dm^3
table(white_wine$residual.sugar<1)

# Vinhos com concentração de açúcar residual superiro a 45 g/dm
table(white_wine$residual.sugar>45)
```

### Cloretos - chlorides (sodium chloride - g / dm^3)

Trata-se da quantidade de sal no vinho.

```{r, echo=FALSE, warning=FALSE}
# Histograma
c1 <- ggplot(aes(x = chlorides), data = white_wine) +
  geom_histogram(binwidth = 0.001)

# Box plot
c2 <- ggplot(aes(x = "X", y = chlorides), data = white_wine) +
  geom_boxplot() +
  coord_flip()

# Organizando exibição dos gráficos
grid.arrange(c1, c2, ncol = 1)
```

```{r, echo=FALSE, warning=FALSE}
# Estatísticas básicas
summary(white_wine$chlorides)
```

Nota-se que a maioria dos vinhos apresentam concentração de cloretos entre 0.036 e 0.050 g/dm^3. Também é possível perceber que existem alguns vinhos com concentrações de cloretos mais elevadas. Assim, podemos aplicar a escala logarítmica de base 10 para aproxiamar a distribuição da normal.

```{r, echo=FALSE, warning=FALSE}
ggplot(aes(x = chlorides), data = white_wine) +
  geom_histogram(binwidth = 0.025) +
  scale_x_log10()
```

Nota-se que utilização da escala logarítmica aproxima reduz o tamanho da cauda à direita.

### Dióxido de Enxofre Livre - free sulfur dioxide (mg / dm^3)

A forma livre de SO2 existe em equilíbrio entre o SO2 molecular (como um gás dissolvido) e ion bisulfito. Trata-se de um agente que impede o crescimento microbiano e a oxidação do vinho.

```{r, echo=FALSE, warning=FALSE}
# Histograma
fsd1 <- ggplot(aes(x = free.sulfur.dioxide), data = white_wine) +
  geom_histogram(binwidth = 1)

# Box plot
fsd2 <- ggplot(aes(x = "X", y = free.sulfur.dioxide), data = white_wine) +
  geom_boxplot() +
  coord_flip()

# Organizando exibição dos gráficos
grid.arrange(fsd1, fsd2, ncol = 1)
```

```{r, echo=FALSE, warning=FALSE}
# Estatísticas básicas
summary(white_wine$free.sulfur.dioxide)
```

Nota-se que a maioria dos vinhos apresentam uma concentração de dióxido de enxofre livre entre 23 e 46 mg/dm^3. Nota-se a presença de outliers apenas à direita da distribuição. Aplicou-se a escala logarítmica com o objetivo de aproximar a distribuição da normal.

```{r, echo=FALSE, warning=FALSE}
ggplot(aes(x = free.sulfur.dioxide), data = white_wine) +
  geom_histogram(binwidth = 0.05) +
  scale_x_log10()
```

### Dióxido de Enxofre Total - total sulfur dioxide (mg / dm^3)

Quantidade de formas livres e ligadas de SO2. Em baixas concentrações, o SO2 é praticamete imperceptível no vinho. Entretando, concentrações de SO2 livre acima de 50 ppm são perceptíveis ao olfato e paladar.

```{r, echo=FALSE, warning=FALSE}
# Histograma
tsd1 <- ggplot(aes(x = total.sulfur.dioxide), data = white_wine) +
  geom_histogram(binwidth = 5)

# Box plot
tsd2 <- ggplot(aes(x = "X", y = total.sulfur.dioxide), data = white_wine) +
  geom_boxplot() +
  coord_flip()

# Organizando exibição dos gráficos
grid.arrange(tsd1, tsd2, ncol = 1)
```

```{r, echo=FALSE, warning=FALSE}
# Estatísticas básicas
summary(white_wine$total.sulfur.dioxide)
```

Nota-se que a maioria dos vinhos apresentam uma concentração total de dióxido de enxofre entre 108 e 167 mg/dm^3.

O código abaixo demostra que apenas 46 vinhos brancos analisados apresentam uma concentração de dióxido de enxofre total inferior a 50 mg/dm^3 (ppm).

```{r,  warning=FALSE}
table(white_wine$total.sulfur.dioxide < 50)
```

### Densidade - density (g / cm^3)

A densidade é próxima a da água dependendo do percentual de teor de álcool e açúcar.

```{r, echo=FALSE, warning=FALSE}
# Histograma
d1 <- ggplot(aes(x = density), data = white_wine) +
  geom_histogram(binwidth = 0.0005)

# Box plot
d2 <- ggplot(aes(x = "X", y = density), data = white_wine) +
  geom_boxplot() +
  coord_flip()

# Organizando exibição dos gráficos
grid.arrange(d1, d2, ncol = 1)
```

```{r, echo=FALSE, warning=FALSE}
# Estatísticas básicas
summary(white_wine$density)
```

Nota-se que a maioria dos vinhos apresentam uma densidade entre 0.9917 e 0.9961 mg/cm^3. Ressalta-se a presença de poucos outliers.

### pH

Descreve o quão ácido ou básico está o vinho em uma escala de 0 (muito ácida) a 14 (muito básico). A maioria dos vinhos apresenta pH entre 3-4.

```{r, echo=FALSE, warning=FALSE}
# Histograma
ph1 <- ggplot(aes(x = pH), data = white_wine) +
  geom_histogram(binwidth = 0.01)

# Box plot
ph2 <- ggplot(aes(x = "X", y = pH), data = white_wine) +
  geom_boxplot() +
  coord_flip()

# Organizando exibição dos gráficos
grid.arrange(ph1, ph2, ncol = 1)
```

```{r, echo=FALSE, warning=FALSE}
# Estatísticas básicas
summary(white_wine$pH)
```

Nota-se que a maioria dos vinhos apresentam um pH entre 3.090 e 3.280.

### Sulfatos - sulphates (potassium sulphate - g / dm3)

Um aditivo que pode contribuir para os níveis de dióxido de enxofre (SO2), que atua como antimicrobiano e antioxidante.

```{r, echo=FALSE, warning=FALSE}
# Histograma
s1 <- ggplot(aes(x = sulphates), data = white_wine) +
  geom_histogram(binwidth = 0.01)

# Box plot
s2 <- ggplot(aes(x = "X", y = sulphates), data = white_wine) +
  geom_boxplot() +
  coord_flip()

# Organizando exibição dos gráficos
grid.arrange(s1, s2, ncol = 1)
```

```{r, echo=FALSE, warning=FALSE}
# Estatísticas básicas
summary(white_wine$sulphates)
```

Nota-se que a maioria dos vinhos apresentam uma concentração de sulfatos entre 0.41 e 0.55 g/dm^3. Também é possível perceber que todos os outliers localizam-se à direita, alongando a cauda da distribuição. O gráfico abaixo utiliza a escala logarítmica para aproximar a distribuição à normal.

```{r, echo=FALSE, warning=FALSE}
# Histograma com escala logarítmica
ggplot(aes(x = sulphates), data = white_wine) +
  geom_histogram(binwidth = 0.025) +
  scale_x_log10()
```

### Álcool - alcohol (% by volume)

O percentual de conteúdo alcoólico do vinho.

```{r, echo=FALSE, warning=FALSE}
# Histograma
a1 <- ggplot(aes(x = alcohol), data = white_wine) +
  geom_histogram(binwidth = 0.1)

# Box plot
a2 <- ggplot(aes(x = "X", y = alcohol), data = white_wine) +
  geom_boxplot() +
  coord_flip()

# Organizando exibição dos gráficos
grid.arrange(a1, a2, ncol = 1)
```

```{r, echo=FALSE, warning=FALSE}
# Estatísticas básicas
summary(white_wine$alcohol)
```

Nota-se que a maioria dos vinhos apresentam um percentual de álcool entre 9.50 e 11.40. Ressalta-se a ausência de outliers para a distribuição da concentração de álcool nos vinhos brancos. A escala logarítmica foi utilizada no gráfico abaixo com o objetivo de aproximar a distribuição à normal

```{r, echo=FALSE, warning=FALSE}
# Histogrma com escala logarítmica
ggplot(aes(x = alcohol), data = white_wine) +
  geom_histogram() +
  scale_x_log10()
```

### Qualidade - quality (score between 0 and 10)

A variável de saída.

```{r, echo=FALSE, warning=FALSE}
# Histograma
q1 <- ggplot(aes(x = as.factor(quality)), data = white_wine) +
  geom_bar()

# Box Plot
q2 <- ggplot(aes(x = "X", y = quality), data = white_wine) +
  geom_jitter(color = "grey") +
  geom_boxplot() +
  coord_flip()

# Organizando exibição dos gráficos
grid.arrange(q1, q2, ncol = 1)
```

```{r, echo=FALSE, warning=FALSE}
# Estatísticas básicas
summary(white_wine$quality)
```

```{r, echo=FALSE, warning=FALSE}
white_wine %>%
  group_by(as.factor(quality)) %>%
  summarise(total = n())
```

Segundo os gráficos acima e a tabela acima, mais de 2000 vinhos apresentaram qualidade 6. Entretanto, tivemos uma pequena quantidade de vinhos com qualidade elevada (8 e 9) e reduzida (3 e 4). Vinhos brancos com qualidade 3, 8 e 9 aparecem como outliers no box plot.

Devido ao interesse em identificar quais propriedades químicas apresentam maior influência na qualidade do vinho branco, adicionou-se uma nova variável ao conjunto de dados conforme código abaixo:

```{r}
white_wine <- white_wine %>%
  mutate(new_quality = cut(quality, breaks = c(2,4,7,10),
                           labels = c("Ruim", "Comum", "Bom")))

str(white_wine$new_quality)
summary(white_wine$new_quality)
```

A variável **new_quality** agrupa os vinhos brancos em 3 classificações de qualidade:

* 3-4 - Ruim
* 5-7 - Comum
* 8-8 - Bom

# Análise Univariada

### Qual é a estrutura do conjunto de dados?

O conjunto de dadados possui 13 variáveis e 4898 observações. Considerando que a variável **X** representa a identificação do vinho, podemos dizer que o conjunto de dados possui 12 variáveis, sendo 11 variáveis de entrada (propriedades químicas do vinho brando) e 1 variável de saída (a nota de qualidade atribuída pelos expecialistas). Algumas observações apresentadas na **Seção de Gráficos Univariados** são recaptuladas abaixo:

* 186 vinhos brancos apresentaram valores de **acidez volátil** elevados (maior que `r va_upper_wisker` g/dm^3) e foram classificados como outliers.
* 185 vinhos brancos apresnetaram concentrações elevadas de **ácido cítrico** (> `r ca_upper_wisker` g/dm^3), enquanto 85 vinhos brancos apresentaram concentrações mais baixas de **ácido cítrico** (< `r ca_lower_wisker` g/dm^3).
* 77 vinhos brancos apresentaram  concentração de **acúcar residual** inferior a 1 g/dm^3, enquanto apenas um vinho branco foi classificado como doce (concentração superior a 45 g/dm^3).
* Apenas 46 vinhos brancos apresentaram concentração de **dióxido de enxofre total** inferior a 50 ppm.
* Apenas 180 vinhos receberam notas "boas" (8-9), enquanto 185 vinhos receberam notas "ruins" (3-4).

### Quais são os principais atributos de interesse deste conjunto de dados?

Avaliando cada uma das 11 variáveis de entrada individualmente, não foi possível identificar quais as propriedades químicas apresentam maior influência na qualidade do vinho branco. Entretanto, a partir da leitura do [arquivo texto que descreve as variáveis](https://s3.amazonaws.com/udacity-hosted-downloads/ud651/wineQualityInfo.txt), acredita-se que os principais atributos de interesse sejam:

* Acidez volatel
* Ácido cítrico
* Açúcar residual
* Dióxido de enxofre total

Na **Seção de Gráficos Bivariados** será investigado o relacionamento entre as propriedades químicas e a nota de qualidade dos vinhos atribuída pelos especialistas.

### Quais outros atributos você acha que podem lhe auxiliar na investigação destes atributos de interesse?

Acredito que o teor de álcool no vinho branco pode ser uma variável influente na qualidade do vinho branco.

### Você criou novas variáveis a partir dos atributos existentes no conjunto de dados?

A variável **new_quality** foi criada com o objetivo de fundamentar as próximas análises. Trata-se de uma classificação das notas de qualidade entre Ruim, Comum e Bom.

### Dos atributos investigados, distribuições incomuns foram encontradas? Você aplicou operações nos dados para limpá-los, ajustá-los ou mudar a forma dos dados? Se sim, por quê?

A concentração de **açúcar residual** apresentou uma distribuição com uma longa cauda à direita. A aplicação da escala logarítmica na distribuição de **açúcar residual** revelou um comportamento bimodal.

A escala logarítmica também foi aplicada às variáveis **acidez volátil**, **cloretos**, **densidade**, **sulfatos** e **álcool** para facilitar a visualização do formato daa distribuição.

# Seção de Gráficos Bivariados

Para o melhor entendimento sobre a influência das propriedades químicas na qualidade dos vinhos, serão avaliadas as correlações entre as propriedades físicas e a nota de qualidade. O gráfico abaixo apresenta a matriz de correlação das variáveis.

```{r echo=FALSE, warning=FALSE, fig.height=9, fig.width=9}
corrplot(cor(subset(white_wine, select = -c(X, new_quality))), method = "number")
```

As propriedades químicas mais fortemente correlacionadas com a qualidade dos vinhos brancos estão listadas abaixo:

* Acidez volátil (`r cor(x = white_wine$volatile.acidity, y = white_wine$quality)`)
* Cloretos (`r cor(x = white_wine$chlorides, y = white_wine$quality)`)
* Dióxido de enxofre total (`r cor(x = white_wine$total.sulfur.dioxide, y = white_wine$quality)`)
* Densidade (`r cor(x = white_wine$density, y = white_wine$quality)`)
* Porcentagem de álcool (`r cor(x = white_wine$alcohol, y = white_wine$quality)`)

No decorrer desta seção de gráficos bivarados será dado ênfase aos atributos de interesse listados na análise univariada e às propriedades químicas mais fortemete correlacionadas com a qualidade dos vinhos brancos:

* Acidez volatel
* Ácido cítrico
* Açúcar residual
* Dióxido de enxofre total
* Cloretos
* Densidade
* Porcentagem de álcool

#### Acidez Volátil Vs. Qualidade

```{r, echo=FALSE, warning=FALSE}
# Histogramas com todas as qualidade
white_wine %>%
  ggplot(aes(x = volatile.acidity)) +
  geom_histogram() +
  facet_wrap(facets = ~new_quality) +
  scale_x_log10()
```

Nota-se que o gráfico acima não permite a identificação das distribuições de qualidade *Ruim* e *Bom*. A distribuição da concentração de **acidez volátil** para os vinhos de qualidade *Comum* apresenta comportamento semelhante à distribuição normal.

```{r, echo=FALSE, warning=FALSE}
# Histogramas Ruim & Bom
white_wine %>%
  filter(new_quality != "Comum") %>%
  ggplot(aes(x = volatile.acidity)) +
  geom_histogram() +
  facet_wrap(facets = ~new_quality) +
  scale_x_log10(name = "log10(volatile.acidity)")
```

Os histogramas acima apresentam o comporta da distribuição da concentração de **acidez volátil** para os vinhos de qualidade *Ruim* e *Bom*. Utilizou-se a escala logarítmica para auxiliar na visualização da distribuição. Os histograma não permitem observar diferença significativa entre na concentração de **acidez volátil** para os vinhos classificados como *Bom* e *Ruim*.

```{r, echo=FALSE, warning=FALSE}
# Gráfico de linha e pontos de variação da média e mediana 
bva1 <- white_wine %>%
  group_by(new_quality) %>%
  summarise(media = mean(volatile.acidity), mediana = median(volatile.acidity)) %>%
  ggplot(aes(x = as.numeric(new_quality))) +
  geom_line(aes(y = media, color = "média")) +
  geom_point(aes(y = media, color = "média")) +
  geom_line(aes(y = mediana, color = "mediana")) +
  geom_point(aes(y = mediana, color = "mediana")) +
  scale_x_continuous(limits = c(1, 3), breaks = seq(1, 3, 1)) +
  scale_y_continuous(name = "volatile.acidity") +
  theme(legend.title = element_blank())

# Box plot
bva2 <- ggplot(aes(x = new_quality, y = volatile.acidity), data = white_wine) +
  geom_boxplot()

# Organizando exibição dos gráficos  
grid.arrange(bva1, bva2, ncol = 1)
```

```{r, echo=FALSE, warning=FALSE}
# Resumo das estatísticas
by(white_wine$volatile.acidity, white_wine$new_quality, summary)
```

Os gráficos acima apresentam: (1) a variação das estatísticas média e mediana para a concentração de **acidez volátil**, e (2) os boxplots que ilustram a presença de outliers entre as classificações de qualidade. Não foi observada diferença significativa entre as concentrações de **acidez volátil** para os vinhos *Comum* e *Bom* (apresentam o mesmo valor mediano). Entretanto, os vinhos brancos classificados como *Ruim* apresentaram maior maior concentração de **acidez volátil**.

#### Ácido Cítrico Vs. Qualidade

```{r echo=FALSE, warning=FALSE}
# Histogramas
white_wine %>%
  filter(new_quality != "Comum") %>%
  ggplot(aes(x = citric.acid)) +
  geom_histogram() +
  facet_wrap(facets = ~new_quality)
```

Os histogramas acima permitem avaliar o formato da distribuição.

```{r echo=FALSE, warning=FALSE}
# Gráfico de linha e pontos de variação da média e mediana 
bca1 <- white_wine %>%
  group_by(new_quality) %>%
  summarise(media = mean(citric.acid), mediana = median(citric.acid)) %>%
  ggplot(aes(x = as.numeric(new_quality))) +
  geom_line(aes(y = media, color = "média")) +
  geom_point(aes(y = media, color = "média")) +
  geom_line(aes(y = mediana, color = "mediana")) +
  geom_point(aes(y = mediana, color = "mediana")) +
  scale_x_continuous(limits = c(1, 3), breaks = seq(1, 3, 1)) +
  scale_y_continuous(name = "citric.acid") +
  theme(legend.title = element_blank())

# Box plot
bca2 <- ggplot(aes(x = new_quality, y = citric.acid), data = white_wine) +
  geom_boxplot() +
  scale_y_continuous(limits = c(0, 0.75))

# Organizando exibição dos gráficos   
grid.arrange(bca1, bca2, ncol = 1)
```

```{r, echo=FALSE, warning=FALSE}
# Resumo das estatísticas
by(white_wine$citric.acid, white_wine$new_quality, summary)
```

Observando os gráficos e tabela acima nota-se que a estatística mediana apresenta o mesmo valor para as concentrações de **ácido cítrico** de vinhos brancos classificados como *Comumn* e *Bom*.

#### Açúcar Residual Vs. Qualidade

```{r echo=FALSE, warning=FALSE}
# Histogramas
white_wine %>%
  filter(new_quality != "Comum") %>%
  ggplot(aes(x = residual.sugar)) +
  geom_histogram() +
  scale_x_log10(name = "log10(residual.sugar)") +
  facet_wrap(facets = ~new_quality)
```

É possível verificar o comportamento bimodal da concentração de **açúcar residual** para os vinhos brancos classificados como *Ruim* e *Bom*.

```{r echo=FALSE, warning=FALSE}
# Gráfico de linha e pontos de variação da média e mediana 
brs1 <- white_wine %>%
  group_by(new_quality) %>%
  summarise(media = mean(residual.sugar), mediana = median(residual.sugar)) %>%
  ggplot(aes(x = as.numeric(new_quality))) +
  geom_line(aes(y = media, color = "média")) +
  geom_point(aes(y = media, color = "média")) +
  geom_line(aes(y = mediana, color = "mediana")) +
  geom_point(aes(y = mediana, color = "mediana")) +
  scale_x_continuous(limits = c(1, 3), breaks = seq(1, 3, 1)) +
  scale_y_continuous(name = "residual.sugar") +
  theme(legend.title = element_blank())

# Box plot
brs2 <- ggplot(aes(x = new_quality, y = residual.sugar), data = white_wine) +
  geom_violin() +
  geom_boxplot(width=.1) +
  scale_y_log10(name = "log10(residual.sugar)")

# Organizando exibição dos gráficos   
grid.arrange(brs1, brs2, ncol = 1)
```

```{r, echo=FALSE, warning=FALSE}
# Resumo das estatísticas
by(white_wine$residual.sugar, white_wine$new_quality, summary)
```

Utilizou-se o violin plot juntamente com o box plot para ressaltar a característica bimodal da distribuição verificada com a utilização da escala logarítmica.

#### Cloretos Vs. Qualidade

```{r echo=FALSE, warning=FALSE}
# Histogramas
white_wine %>%
  filter(new_quality != "Comum") %>%
  ggplot(aes(x = chlorides)) +
  geom_histogram() +
  scale_x_log10(name = "log10(chlorides)") +
  facet_wrap(facets = ~new_quality)
```

```{r echo=FALSE, warning=FALSE}
# Gráfico de linha e pontos de variação da média e mediana 
bc1 <- white_wine %>%
  group_by(new_quality) %>%
  summarise(media = mean(chlorides), mediana = median(chlorides)) %>%
  ggplot(aes(x = as.numeric(new_quality))) +
  geom_line(aes(y = media, color = "média")) +
  geom_point(aes(y = media, color = "média")) +
  geom_line(aes(y = mediana, color = "mediana")) +
  geom_point(aes(y = mediana, color = "mediana")) +
  scale_x_continuous(limits = c(1, 3), breaks = seq(1, 3, 1)) +
  scale_y_continuous(name = "chlorides") +
  theme(legend.title = element_blank())

# Box plot
bc2 <- ggplot(aes(x = new_quality, y = chlorides), data = white_wine) +
  geom_boxplot() +
  scale_y_continuous(limits = c(0, 0.1))

# Organizando exibição dos gráficos   
grid.arrange(bc1, bc2, ncol = 1)
```

```{r, echo=FALSE, warning=FALSE}
# Resumo das estatísticas
by(white_wine$chlorides, white_wine$new_quality, summary)
```

Observa-se uma leve tendência decrescente da concentração de **clorestos** para vinhos brancos de melhor qualidade.

#### Dióxido de Enxofre Total Vs. Qualidade

```{r echo=FALSE, warning=FALSE}
# Histogramas
white_wine %>%
  filter(new_quality != "Comum") %>%
  ggplot(aes(x = total.sulfur.dioxide)) +
  geom_histogram() +
  facet_wrap(facets = ~new_quality)
```

```{r echo=FALSE, warning=FALSE}
# Gráfico de linha e pontos de variação da média e mediana 
btsd1 <- white_wine %>%
  group_by(new_quality) %>%
  summarise(media = mean(total.sulfur.dioxide), mediana = median(total.sulfur.dioxide)) %>%
  ggplot(aes(x = as.numeric(new_quality))) +
  geom_line(aes(y = media, color = "média")) +
  geom_point(aes(y = media, color = "média")) +
  geom_line(aes(y = mediana, color = "mediana")) +
  geom_point(aes(y = mediana, color = "mediana")) +
  scale_x_continuous(limits = c(1, 3), breaks = seq(1, 3, 1)) +
  scale_y_continuous(name = "total.sulfur.dioxide") +
  theme(legend.title = element_blank())

# Box plot
btsd2 <- ggplot(aes(x = new_quality, y = total.sulfur.dioxide), data = white_wine) +
  geom_boxplot()
  
# Organizando exibição dos gráficos   
grid.arrange(btsd1, btsd2, ncol = 1)
```

```{r, echo=FALSE, warning=FALSE}
# Resumo das estatísticas
by(white_wine$total.sulfur.dioxide, white_wine$new_quality, summary)
```

Observa-se que o comportamento das estatísticas média e mediana não são paralelos. O gráfico de linhas e pontos mostra que, vinhos com classificação *Ruim* possuem média superior, porém mediana inferior quando comparados aos vinhos de classificação *Boa*.

Segundo informações retiradas [deste arquivo texto](https://s3.amazonaws.com/udacity-hosted-downloads/ud651/wineQualityInfo.txt), a concentração de **dióxido de enxofre total** passa a ser perceptível ao olfato e paladar a partir de 50 ppm. Apenas 46 vinhos brancos apresentaram concentração de **dióxido de enxofre total** inferior a 50 ppm. O código abaixo mostra que nenhum dos 46 vinhos brancos com concentração de **dióxido de enxofre total** inferior a 50 ppm foi classificado como *Bom*.

```{r}
white_wine %>%
  filter(total.sulfur.dioxide < 50) %>%
  group_by(new_quality) %>%
  summarise(total = n())
```

#### Densidade Vs. Qualidade

```{r echo=FALSE, warning=FALSE}
# Histogramas
white_wine %>%
  filter(new_quality != "Comum") %>%
  ggplot(aes(x = density)) +
  geom_histogram() +
  facet_wrap(facets = ~new_quality)
```

```{r echo=FALSE, warning=FALSE}
# Gráfico de linha e pontos de variação da média e mediana 
bd1 <- white_wine %>%
  group_by(new_quality) %>%
  summarise(media = mean(density), mediana = median(density)) %>%
  ggplot(aes(x = as.numeric(new_quality))) +
  geom_line(aes(y = media, color = "média")) +
  geom_point(aes(y = media, color = "média")) +
  geom_line(aes(y = mediana, color = "mediana")) +
  geom_point(aes(y = mediana, color = "mediana")) +
  scale_x_continuous(limits = c(1, 3), breaks = seq(1, 3, 1)) +
  scale_y_continuous(name = "density") +
  theme(legend.title = element_blank())

# Box plot
bd2 <- ggplot(aes(x = new_quality, y = density), data = white_wine) +
  geom_boxplot() +
  scale_y_continuous(limits = c(0.985, 1.005))
  
# Organizando exibição dos gráficos   
grid.arrange(bd1, bd2, ncol = 1)
```

```{r, echo=FALSE, warning=FALSE}
# Resumo das estatísticas
by(white_wine$density, white_wine$new_quality, summary)
```

Observa-se que vinhos com **densidades** menores tendem a apesentar melhor qualidade.

#### Álcool Vs. Qualidade

```{r echo=FALSE, warning=FALSE}
# Histogramas
white_wine %>%
  filter(new_quality != "Comum") %>%
  ggplot(aes(x = alcohol)) +
  geom_histogram() +
  facet_wrap(facets = ~new_quality)
```

```{r echo=FALSE, warning=FALSE}
# Gráfico de linha e pontos de variação da média e mediana 
ba1 <- white_wine %>%
  group_by(new_quality) %>%
  summarise(media = mean(alcohol), mediana = median(alcohol)) %>%
  ggplot(aes(x = as.numeric(new_quality))) +
  geom_line(aes(y = media, color = "média")) +
  geom_point(aes(y = media, color = "média")) +
  geom_line(aes(y = mediana, color = "mediana")) +
  geom_point(aes(y = mediana, color = "mediana")) +
  scale_x_continuous(limits = c(1, 3), breaks = seq(1, 3, 1)) +
  scale_y_continuous(name = "alcohol") +
  theme(legend.title = element_blank())

# Box plot
ba2 <- ggplot(aes(x = new_quality, y = alcohol), data = white_wine) +
  geom_boxplot()
  
# Organizando exibição dos gráficos   
grid.arrange(ba1, ba2, ncol = 1)
```

```{r, echo=FALSE, warning=FALSE}
# Resumo das estatísticas
by(white_wine$alcohol, white_wine$new_quality, summary)
```

Observa-se que vinhos com teor de **álcool** maiores tendem a apesentar melhor qualidade.

# Análise Bivariada

### Discuta sobre alguns dos relacionamentos observados nesta parte da investigação. Como os atributos de interesse variaram no conjunto de dados?

As propriedades químicas mais fortemente correlacionadas com a qualidade dos vinhos brancos estão listadas abaixo:

No decorrer desta análise bivariáda foi dado ênfase aos atributos de interesse listados abaixo. Os mesmos estão acompanhados de seus respectivos coeficientes de correlação linear com a variável **qualidade**.

* Acidez volátil (`r cor(x = white_wine$volatile.acidity, y = white_wine$quality)`)
* Ácido cítrico (`r cor(x = white_wine$citric.acid, y = white_wine$quality)`)
* Açúcar residual (`r cor(x = white_wine$residual.sugar, y = white_wine$quality)`)
* Dióxido de enxofre total (`r cor(x = white_wine$total.sulfur.dioxide, y = white_wine$quality)`)
* Cloretos (`r cor(x = white_wine$chlorides, y = white_wine$quality)`)
* Densidade (`r cor(x = white_wine$density, y = white_wine$quality)`)
* Porcentagem de álcool (`r cor(x = white_wine$alcohol, y = white_wine$quality)`)

Algumas observações apresentadas na **Seção de Gráficos Bnivariados** são recaptuladas abaixo:

* Não foi observada diferença significativa entre as concentrações de **acidez volátil** para os vinhos *Comum* e *Bom* (apresentam o mesmo valor mediano).
* Vinhos brancos classificados como *Ruim* apresentaram maior concentração de **acidez volátil**.
* Vinhos brancos classificados como *Ruim* apresentam concentração de **ácido cítrico** levemente inferior a vinhos *Comuns* e *Bons*.
* O comportamento bimodal da concentração de **açúcar residual** é reafirmado.
* Vinhos *Bons* apresentam baixas concentrações de **cloretos**.
* Concentrações de **dióxido de enxofre total** superiores a 50 ppm não aparentam influenciar a qualidade do vinho branco.
* Os melhores vinhos apresentam as menores **densidades**.
* Os melhores vinhos apresentam o maior teor de **álcool**.

### Você observou algum relacionamento interessante entre os outros atributos (os que não são de interesse)?

Foi interessante verificar que as estatísticas medianas das concentrações de **acidez volátil** e **ácido cítrico**, para vinhos brancos classificados como *Comuns* ou *Bons* apresentaram os mesmos valores.

Outro relacionamento interessante, porêm esperadado, foram as fortes correlações lineares entre **densidade** e **açúcar residual** (`r cor(x = white_wine$density, y = white_wine$residual.sugar)`) e **densidade** e **álcool** (`r cor(x = white_wine$density, y = white_wine$alcohol)`).

### Qual foi o relacionamento mais forte encontrado?

A análise bivariada revelou que o relacionamento mais forte envolvendo a variável qulidade está entre a porcentagem de álcool e a qualidade do vinho, que apresentou uma correlação linear moderada positiva de `r cor(x = white_wine$alcohol, y = white_wine$quality)`.

# Seção de Gráficos Multivariados

#### Álcool & Densidade Vs. Qualidade

Avaliou-se as duas propriedades químicas que apresentaram a maior correlação com a qualidade do vinho branco. É interessante notar que a porcentagem de álcool e a densidade do vinho branco também apresentam uma forte correlação entre si (`r cor(x = white_wine$alcohol, y = white_wine$density)`).

```{r echo=FALSE, warning=FALSE}
ggplot(aes(x = density, y = alcohol, color = new_quality), data = white_wine) +
  geom_jitter() +
  scale_x_continuous(limits = c(0.985, 1.005))
```

O gráfico acima confirma a forte correlação linear negativa entre as propriedades **densidade** e porcentagem de **álcool**. Entretanto, o mesmo não permite visualizar com clareza a distribuição entre os vinhos *Ruins*, *Comuns* e *Bons*. O gráfico abaixo segrega os pontos por qualidade do vinho branco.

```{r echo=FALSE, warning=FALSE}
ggplot(aes(x = density, y = alcohol, color = new_quality), data = white_wine) +
  geom_jitter() +
  scale_x_continuous(limits = c(0.985, 1.005)) +
  facet_wrap(facets = ~new_quality)
```

O gráfico acima mostra uma tendência de vinhos brancos com alto teor de álcool e, por consequência, baixa densidade apresentarem a melhor qualidade. Por outro lado, vinhos branco de baixo teor de álcool e alta densidade tendem a apresentar menor qualidade.

Com o objetivo de faciliatr a visualização dos dados, o gráfico abaixo apresenta apenas os vinhos brancos classificados como *Ruins* ou *Bons*.

```{r echo=FALSE, warning=FALSE}
white_wine %>%
  filter(new_quality != "Comum") %>%
  ggplot(aes(x = density, y = alcohol, color = new_quality)) +
  geom_jitter() +
  geom_smooth(method = "lm")
```

Observando as linhas de tendência é possível perceber para uma mesma densidade, vinhos com maior teor de álcool tendem a apresentar uma melhor qualidade. Esta relação tende a enfraquecer para densidades mais elevadas (ou teores alcólicos mais baixos).

#### Açúcar Residual & Densidade Vs. Qualidade

As propriedades químicas açúcar residual e densidade apresentam a maior correlação entre as propriedades do vinho branco (`r cor(x = white_wine$residual.sugar, y = white_wine$density)`). O gráfico abaixo mostra a variação destas duas propriedades químicas em função da qualidade do vinho branco.

```{r echo=FALSE, warning=FALSE}
white_wine %>%
  filter(new_quality != "Comum") %>%
  ggplot(aes(x = density, y = residual.sugar, color = new_quality)) +
  geom_jitter() +
  geom_smooth(method = "lm")
```

O gráfico acima mostra, que para uma mesma densidade, os vinhos branco com maior concentração de açúcar residual tendem a apresentar melhor qualidade.

#### Açúcar Residual & Álcool Vs. Qualidade

```{r echo=FALSE, warning=FALSE}
white_wine %>%
  filter(new_quality != "Comum") %>%
  ggplot(aes(x = alcohol, y = residual.sugar, color = new_quality)) +
  geom_jitter() +
  geom_smooth(method = "lm")
```

Observando o gráfico acima não é possível observar uma correlação linear entre o teor de álcool e a concentração de açúcar residual. Entretanto, nota-se que, considerando o mesmo teor de álcool, vinhos brancos com maior concentração de açúcar residual tendem a apresnetar melhor qualidade.

#### Açúcar Residual & Ácido Cítrico Vs. Qualidade

```{r echo=FALSE, warning=FALSE}
white_wine %>%
  filter(new_quality != "Comum") %>%
  ggplot(aes(x = residual.sugar, y = citric.acid, color = new_quality)) +
  geom_jitter() +
  geom_smooth(method = "lm") +
  geom_vline(xintercept = 8.75) +
  geom_hline(yintercept = 0.4375)
```

O gráfico acima confirma a quase inexistência de correlação entre as propriedades químicas **ácido cítrico** e **açúcar residual**. Com o auxílio dos quadrantes é possível que vinhos brancos *Ruins* tendem a apresentar baixo **açúcar residual** e baixa concentração de **ácido cítrico**.

#### Álcool & Cloretos Vs. Qualidade

```{r echo=FALSE, warning=FALSE}
white_wine %>%
  filter(new_quality != "Comum") %>%
  ggplot(aes(x = chlorides, y = alcohol, color = new_quality)) +
  geom_jitter() +
  geom_smooth(method = "lm") +
  scale_x_continuous(limits = c(0, 0.1)) +
  geom_vline(xintercept = 0.05) +
  geom_hline(yintercept = 11)
```

O gráfico acima confirma a correlação linear negativa entra a porcentagem de álcool e concentração de cloretos no vinho branco. Também é possível perceber que os melhores vinhos tendem a apresentar um alto teor de álcool e baixas concentrações de cloretos.

#### Cloretos & Densidade Vs. Qualidade

```{r echo=FALSE, warning=FALSE}
white_wine %>%
  filter(new_quality != "Comum") %>%
  ggplot(aes(x = density, y = chlorides, color = new_quality)) +
  geom_jitter() +
  geom_smooth(method = "lm") +
  scale_y_continuous(limits = c(0, 0.1)) +
  geom_vline(xintercept = 0.993755) +
  geom_hline(yintercept = 0.05)
```

O gráfico acima confirma que bons vinhos apresentam baixa densidade e concentração de cloretos. Para uma mesma densidade, existe pouca diferênça entre as concentrações de cloretos entre vinhos *Bons* e *Ruins*.

# Análise Multivariada

### Discuta sobre os relacionamentos observados nesta parte da investigação. Quais atributos que fortaleceram os demais na observação das variáveis de interesse?

* Para uma mesma densidade, vinhos com maior teor de álcool tendem a apresentar uma melhor qualidade.
* A forte correlação entre as propriedade química densidade e concentração de açúcar residual fortaleceu a hipótese de que a concentração de açúcar residual possa influenciar na qualidade do vinho branco.
* Os melhores vinhos tendem a apresentar um alto teor de álcool e baixas concentrações de cloretos.
* Para uma mesma densidade, existe pouca diferênça entre as concentrações de cloretos entre vinhos *Bons* e *Ruins*.

### Interações surpreendentes e/ou interessantes foram encontradas entre os atributos?

A correlação entre as propriedades químicas densidade, álcool e açucar residual era esperda. Entertanto, foi interessante vericar que, para este conjunto de dados, as propriedades químicas relacionada a acidez e enxofre não apresentaram correlação significativa com a qualidade dos vinhos brancos.

Apesar da distribuição da concentração de açúcar residual apresentar comportamento bimodal e fraca correlação linear com a variável qualidade, foi interessante verificar, que para uma mesma densidade, os vinhos brancos tendem a apresentar uma melhor qualidade para maiores concentrações de açúcar residual.

### OPCIONAL: Modelos foram criados usando este conjunto de dados? Discuta sobre os pontos fortes e as limitações do seu modelo.

Até o presente momento, não criei modelos a partir do banco de dados em estudo.

------

# Gráficos Finais e Sumário

### Primeiro Gráfico
```{r echo=FALSE, warning=FALSE, Plot_One}
pg1 <- ggplot(aes(x = as.factor(quality), fill = as.factor(quality)),
       data = white_wine) +
  geom_bar() +
  scale_fill_economist() +
  scale_y_continuous(name = "nº de Vinhos Brancos") +
  scale_x_discrete(name = "Nota de Qualidade") +
  ggtitle(label = "Nota de Qualidade dos Vinhos Brancos") +
  theme(plot.title = element_text(hjust = 0.5),
        legend.position = "none")

pg2 <- ggplot(aes(x = new_quality, fill = new_quality),
       data = white_wine) +
  geom_bar() +
  scale_fill_economist() +
  scale_y_continuous(name = "nº de Vinhos Brancos") +
  scale_x_discrete(name = "Qualidade") +
  ggtitle(label = "Qualidade dos Vinhos Brancos") +
  theme(plot.title = element_text(hjust = 0.5),
        legend.position = "none")

grid.arrange(pg1, pg2, ncol = 2)
```

### Descrição do Primeiro Gráfico

O *Primeiro gráfico* apresneta a classificação original da qualidade dos vinhos brancos dada pelos especialistas e a nova classificação de qualidade sugerida pelo autor no decorrer da análise:

* Qualidade 3-4: Ruim
* Qualidade 5-7: Comum
* Qualidade 8-9: Bom

Nota-se que a distribuição das notas de qualidade dos vinhos brancos apresenta comportamento semelhante à distribuição normal, sendo a maioria dos vinhos (> 4000) classificados com notas intermediárias (5, 6 e 7). A nota de qualidade em destaque é a nota 6. Vinhos considerados bons e ruins são igualmente incomuns no conjunto de dados analisado.

### Segundo Gráfico
```{r echo=FALSE, warning=FALSE, Plot_Two}
ggplot(aes(x = density, y = residual.sugar,
           color = new_quality),
       data = white_wine) +
  geom_smooth(method = "lm") +
  scale_y_continuous(name = "Açúcar Residual / (g.cm^-3)",
                     limits = c(0, 20),
                     breaks = seq(0, 20, 2.5)) +
  scale_x_continuous(name = "Densidade / (g.cm^-3)",
                     limits = c(0.990, 1.000),
                     breaks = seq(0.990, 1.000, 0.001)) +
  ggtitle(label = "Relação Açúcar Residual Vs. Densidade") +
  theme_light() +
  theme(plot.title = element_text(hjust = 0.5),
        legend.title = element_blank(),
        legend.justification=c(1,0),
        legend.position=c(1,0))
```

### Descrição do Segundo Gráfico

O *Segundo gráfico* ilustra a forte correlação positiva (`r cor(white_wine$residual.sugar, white_wine$density)`) entre a concentração de açúcar residual e densidade dos vinhos brancos através de linhas de tendência. O objetivo é mostrar que, apesar da quase inexistência de correlação entre a concentração de açúcar residual e a qualidade dos vinhos brancos (`r cor(white_wine$residual.sugar, white_wine$quality)`), considerando uma mesma densidade, os melhores vinhos brancos tendem a apresentar maior concentração de açúcar residual.

### Terceiro Gráfico
```{r echo=FALSE, warning=FALSE, Plot_Three}
ggplot(aes(x = density, y = alcohol, color = new_quality),
       data = white_wine) +
  geom_vline(xintercept = 0.995, color = "grey") +
  geom_hline(yintercept = 11, color = "grey") +
  geom_jitter(alpha = 0.3) +
  geom_smooth(method = "lm", color = "black") +
  scale_color_economist() +
  facet_wrap(facets = ~new_quality) +
  scale_x_continuous(name = "Densidade / (g.cm^-3)",
                     limits = c(0.985,1.005),
                     breaks = seq(0.985,1.005,0.01)) +
  scale_y_continuous(name = "% de Álcool",
                     breaks = seq(8,14,1)) +
  ggtitle(label = "Relação Álcool Vs. Densidade") +
  theme(plot.title = element_text(hjust = 0.5),
        legend.position = "none")
```

### Descrição do Terceiro Gráfico

O *Terceiro Gráfico* deixa claro a forte correlação linear (`r cor(white_wine$alcohol, white_wine$density)`) existente entre o teor de álcool e a densidade do vinho branco. A divisão dos planos cartesianos em quadrantes tem o objetivo de facilitar a visualização. Nota-se que os melhores vinhos brancos são aqueles que apresentam o maior teor de álcool e, por consequência, a menor densidade.

------

# Reflexão

A presente análise exploratória dos dados referentes às propriedades químicas e qualidade de vinhos brancos apontou para as seguintes conclusões:

1. Vinhos com qualidade igual a 6 são mais frequentes.
2. As propriedades químicas **densidade** e **açúcar residual** apresentam a mais forte correlação dentre as variáveis esploradas (`r cor(x = white_wine$density, y = white_wine$residual.sugar)`), indicando que quando a concentração de açúcar residual aumenta, a densidade também aumenta.
3. As propriedades químicas porcentágem de **álcool** e **densidade** apresentam uma forte correlação linear negativa (`r cor(x = white_wine$alcohol, y = white_wine$density)`), indicando que quanto maior a concentração de álcool, menor será a densidade do vinho branco.
4. A propriedade química **cloretos** apresenta a terceira maior correlação linear com a variável **qualidade** (`r cor(x = white_wine$chlorides, y = white_wine$quality)`).
5. As variáveis **cloretos** e **álcool** apresnetam uma correlação linear negativa (`r cor(x = white_wine$chlorides, y = white_wine$alcohol)`).
6. As variáveis **cloretos** e **densidade** apresnetam uma correlação linear positiva (`r cor(x = white_wine$chlorides, y = white_wine$density)`).

Não é possível desconsiderar o gosto pessoal dos especialistas que avaliaram os vinhos brancos. Seria interessante e enriquecedor para a análise conhecer a nota de cada especialista para cada vinho. O conhecimento de outras variáveis como ano da safra, tipo da uva e marca do vinho também entiqueceriam a análise.

Em análises futuras pretendo criar de modelos de previsão.

# Referências

P. Cortez, A. Cerdeira, F. Almeida, T. Matos and J. Reis. Modeling wine preferences by data mining from physicochemical properties. In Decision Support Systems, Elsevier, 47(4):547-553. ISSN: 0167-9236.

Available at: 

* [@Elsevier] http://dx.doi.org/10.1016/j.dss.2009.05.016
* [Pre-press (pdf)] http://www3.dsi.uminho.pt/pcortez/winequality09.pdf
* [bib] http://www3.dsi.uminho.pt/pcortez/dss09.bib

